<!DOCTYPE html>
<html>
<head>
    <title>–°–ø–æ—Ä—Ç–ù–æ–≤–æ—Å—Ç–∏</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; font-family: Arial; background: #f0f0f0; }
        .header { background: #1a2a3a; color: white; font-size: 24px; padding: 15px; text-align: center; }
        .container { max-width: 900px; margin: 10px auto; padding: 10px; }
        
        /* –†–µ–∫–ª–∞–º–Ω—ã–π –±–ª–æ–∫ */
        .ad-container {
            max-width: 900px;
            margin: 10px auto;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px dashed #6c757d;
            text-align: center;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .ad-banner {
            width: 100%;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
        }
        .ad-placeholder {
            color: #6c757d;
            padding: 15px;
            font-style: italic;
        }
        .ad-banner img {
            max-width: 100%;
            height: auto;
            display: block;
        }
        .ad-banner video {
            width: 100%;
            max-height: 120px;
            object-fit: cover;
        }
        
        /* –í–∫–ª–∞–¥–∫–∏ */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: #ddd;
            cursor: pointer;
            border-radius: 8px;
            font-weight: bold;
            transition: 0.3s;
        }
        .tab.active {
            background: #1a2a3a;
            color: white;
        }
        .tab.football.active { background: #27ae60; }
        .tab.hockey.active { background: #e67e22; }
        
        /* –ù–æ–≤–æ—Å—Ç–∏ */
        .news-column {
            background: white;
            padding: 20px;
            border-radius: 10px;
            min-height: 300px;
        }
        .news-item {
            border-bottom: 1px solid #eee;
            padding: 15px 0;
        }
        .news-item:first-child {
            padding-top: 0;
        }
        .news-item:last-child {
            border-bottom: none;
        }
        .news-date {
            color: #7f8c8d;
            font-size: 12px;
            margin-bottom: 5px;
        }
        .news-title {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
        }
        .news-text {
            color: #34495e;
        }
        
        /* –ê–¥–º–∏–Ω–∫–∞ */
        .admin-btn { 
            position: fixed; 
            top: 10px; 
            right: 10px; 
            background: #1a2a3a; 
            color: white; 
            border: 0; 
            padding: 8px 15px; 
            border-radius: 5px; 
            cursor: pointer; 
            z-index: 999; 
        }
        .admin-panel { 
            background: #fff3cd; 
            padding: 20px; 
            border-radius: 10px; 
            margin: 10px 0 20px 0; 
            border: 2px solid #ffc107; 
        }
        input, textarea, select { 
            width: 100%; 
            margin: 5px 0; 
            padding: 8px; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
            box-sizing: border-box; 
        }
        button { 
            background: #1a2a3a; 
            color: white; 
            border: 0; 
            padding: 8px 15px; 
            border-radius: 4px; 
            cursor: pointer; 
        }
        button.delete {
            background: #dc3545;
            padding: 3px 8px;
            margin-left: 10px;
            font-size: 12px;
        }
        .login-box { 
            background: white; 
            padding: 20px; 
            border-radius: 10px; 
            max-width: 300px; 
            margin: 20px auto; 
            box-shadow: 0 0 10px rgba(0,0,0,0.1); 
        }
        .hidden { display: none; }
        
        /* –§–æ—Ä–º—ã –≤ –∞–¥–º–∏–Ω–∫–µ */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }
        .ad-settings {
            background: #e2e3e5;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .ad-status {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>

<div class="header">‚öΩ –°–ü–û–†–¢–ù–û–í–û–°–¢–ò üèí</div>

<!-- –†–ï–ö–õ–ê–ú–ù–´–ô –ë–õ–û–ö - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã -->
<div class="ad-container" id="adContainer">
    <div class="ad-banner" id="adBanner">
        <!-- –°—é–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —Ä–µ–∫–ª–∞–º–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã -->
        <!-- Yandex.RTB R-A-18765769-1 -->
<div id="yandex_rtb_R-A-18765769-1"></div>
<script>
window.yaContextCb.push(() => {
    Ya.Context.AdvManager.render({
        "blockId": "R-A-18765769-1",
        "renderTo": "yandex_rtb_R-A-18765769-1"
    })
})
</script>
    </div>
</div>

<!-- –ö–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω–∫–∏ -->
<button class="admin-btn" onclick="showLogin()">üîë –ê–¥–º–∏–Ω–∫–∞</button>

<div class="container">
    <!-- –û–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div id="loginModal" class="hidden">
        <div class="login-box">
            <h3>üîê –í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
            <input type="password" id="passwordInput" placeholder="–ü–∞—Ä–æ–ª—å">
            <button onclick="checkPassword()">–í–æ–π—Ç–∏</button>
            <button onclick="hideLogin()">–û—Ç–º–µ–Ω–∞</button>
            <div id="loginError" style="color:red; margin-top:10px;"></div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∞ -->
    <div id="adminPanel" class="admin-panel hidden">
        <h3>‚öôÔ∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h3>
        
        <!-- –°—Ç–∞—Ç—É—Å —Ä–µ–∫–ª–∞–º—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã -->
        <div id="adStatus" class="ad-status">–¢–µ–∫—É—â–∞—è —Ä–µ–∫–ª–∞–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...</div>
        
        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–æ–π (–≤ —Ç–∞–±–ª–∏—Ü–µ) -->
        <div class="ad-settings">
            <h4 style="margin-top:0;">üì¢ –†–µ–∫–ª–∞–º–∞ –∏–∑ Google –¢–∞–±–ª–∏—Ü—ã</h4>
            <p style="font-size: 14px;">–†–µ–∫–ª–∞–º–∞ –±–µ—Ä–µ—Ç—Å—è –∏–∑ –ª–∏—Å—Ç–∞ "–†–µ–∫–ª–∞–º–∞" –≤ —Ç–≤–æ–µ–π —Ç–∞–±–ª–∏—Ü–µ. 
            –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∫–ª–∞–º—É –¥–ª—è –≤—Å–µ—Ö, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π —Ç–∞–±–ª–∏—Ü—É.</p>
            <button onclick="forceReloadAd()" style="background:#28a745;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∫–ª–∞–º—É –∏–∑ —Ç–∞–±–ª–∏—Ü—ã</button>
            
            <hr>
            
            <h4>‚ö° –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–¥–ª—è —Ç–µ—Å—Ç–∞)</h4>
            <select id="adType">
                <option value="none">–ë–µ–∑ —Ä–µ–∫–ª–∞–º—ã</option>
                <option value="image">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–±–∞–Ω–Ω–µ—Ä)</option>
                <option value="video">–í–∏–¥–µ–æ—Ä–æ–ª–∏–∫</option>
                <option value="yandex">–Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç (–∫–æ–¥)</option>
            </select>
            
            <div id="imageAdInput" class="hidden">
                <input type="text" id="adImageUrl" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É">
                <input type="text" id="adLinkUrl" placeholder="–°—Å—ã–ª–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞">
            </div>
            
            <div id="videoAdInput" class="hidden">
                <input type="text" id="adVideoUrl" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª">
                <label>
                    <input type="checkbox" id="adVideoMuted" checked> –ë–µ–∑ –∑–≤—É–∫–∞
                </label>
            </div>
            
            <div id="yandexAdInput" class="hidden">
                <textarea id="adYandexCode" rows="3" placeholder="–ö–æ–¥ —Ä–µ–∫–ª–∞–º–Ω–æ–π —Å–µ—Ç–∏"></textarea>
            </div>
            
            <p style="font-size:12px; color:#666;">* –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–∞—è. –î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ä–µ–∫–ª–∞–º—ã –¥–æ–±–∞–≤—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É.</p>
        </div>
        
        <h4>‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π</h4>
        <div class="form-grid">
            <div>
                <h4 style="color:#27ae60;">‚öΩ –§—É—Ç–±–æ–ª</h4>
                <input id="fDate" placeholder="–î–∞—Ç–∞" value="19.02.2026">
                <input id="fTitle" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
                <textarea id="fText" placeholder="–¢–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏"></textarea>
                <button onclick="addNews('football')">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <div>
                <h4 style="color:#e67e22;">üèí –•–æ–∫–∫–µ–π</h4>
                <input id="hDate" placeholder="–î–∞—Ç–∞" value="19.02.2026">
                <input id="hTitle" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
                <textarea id="hText" placeholder="–¢–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏"></textarea>
                <button onclick="addNews('hockey')">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </div>
        <button onclick="logout()" style="background: #dc3545;">–í—ã–π—Ç–∏</button>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∏ -->
    <div class="tabs">
        <div class="tab football active" onclick="showTab('football')">‚öΩ –§–£–¢–ë–û–õ</div>
        <div class="tab hockey" onclick="showTab('hockey')">üèí –•–û–ö–ö–ï–ô</div>
    </div>

    <!-- –ù–æ–≤–æ—Å—Ç–∏ -->
    <div id="footballTab" class="news-column">
        <div id="footballNews">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    
    <div id="hockeyTab" class="news-column hidden">
        <div id="hockeyNews">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
</div>

<script>
// ======== –ù–ê–°–¢–†–û–ô–ö–ò ========
const SECRET_PASSWORD = "sport123";
// –í–°–¢–ê–í–¨ –°–í–û–Æ –°–°–´–õ–ö–£ –ù–ê CSV (–¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π)
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTJ4YwTscKacmVUgHmXUcQtizBM_I-WJJc-BlbQiVLYyXIDVquXaZv39P0HQCGHV0MLugsy2K8FtCwD/pub?output=csv";
// –°–°–´–õ–ö–ê –î–õ–Ø –†–ï–ö–õ–ê–ú–´ (—Ç–æ—Ç –∂–µ —Ñ–∞–π–ª, –Ω–æ –ª–∏—Å—Ç "–†–µ–∫–ª–∞–º–∞")
const AD_SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTJ4YwTscKacmVUgHmXUcQtizBM_I-WJJc-BlbQiVLYyXIDVquXaZv39P0HQCGHV0MLugsy2K8FtCwD/pub?gid=1551898537&single=true&output=csv";

let isAdmin = false;
let allNews = [];
let adRotationTimer = null;

// ======== –ó–ê–ì–†–£–ó–ö–ê –†–ï–ö–õ–ê–ú–´ –ò–ó –¢–ê–ë–õ–ò–¶–´ ========

// –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∫–ª–∞–º—É –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
async function loadAdFromSheet() {
    try {
        const response = await fetch(AD_SHEET_URL);
        const csv = await response.text();
        
        // –†–∞–∑–±–∏—Ä–∞–µ–º CSV
        const rows = csv.split('\n').map(row => row.split(','));
        
        // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É —Å –¥–∞–Ω–Ω—ã–º–∏ (–ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
        if (rows.length > 1) {
            const adRow = rows[1]; // –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
            
            if (adRow.length >= 1) {
                const adType = adRow[0].replace(/"/g, '').trim();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ –∞–¥–º–∏–Ω–∫–µ
                document.getElementById('adStatus').innerHTML = `‚úÖ –†–µ–∫–ª–∞–º–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã: —Ç–∏–ø "${adType}"`;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∫–ª–∞–º—É
                showAd(adRow);
                return;
            }
        }
        
        // –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ
        document.getElementById('adStatus').innerHTML = '‚ö†Ô∏è –í —Ç–∞–±–ª–∏—Ü–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ä–µ–∫–ª–∞–º–µ. –î–æ–±–∞–≤—å —Å—Ç—Ä–æ–∫—É –≤ –ª–∏—Å—Ç "–†–µ–∫–ª–∞–º–∞"';
        document.getElementById('adBanner').innerHTML = '<div class="ad-placeholder">üì¢ –†–µ–∫–ª–∞–º–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞</div>';
        
    } catch(e) {
        console.log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∫–ª–∞–º—ã:', e);
        document.getElementById('adStatus').innerHTML = '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∫–ª–∞–º—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã';
        document.getElementById('adBanner').innerHTML = '<div class="ad-placeholder">‚è≥ –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∫–ª–∞–º—ã</div>';
    }
}

// –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∫–ª–∞–º—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
function showAd(adRow) {
    const adType = adRow[0].replace(/"/g, '').trim();
    const link1 = adRow.length > 1 ? adRow[1].replace(/"/g, '').trim() : '';
    const link2 = adRow.length > 2 ? adRow[2].replace(/"/g, '').trim() : '';
    const extra = adRow.length > 3 ? adRow[3].replace(/"/g, '').trim() : '';
    
    const adBanner = document.getElementById('adBanner');
    
    if (adType === 'none' || adType === '') {
        adBanner.innerHTML = '<div class="ad-placeholder">üì¢ –†–µ–∫–ª–∞–º–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞</div>';
    }
    else if (adType === 'image') {
        if (link1) {
            const href = link2 || '#';
            adBanner.innerHTML = `<a href="${href}" target="_blank"><img src="${link1}" alt="–†–µ–∫–ª–∞–º–∞" style="max-width:100%;"></a>`;
        } else {
            adBanner.innerHTML = '<div class="ad-placeholder">‚ùå –ù–µ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>';
        }
    }
    else if (adType === 'video') {
        if (link1) {
            const muted = extra === 'muted' ? 'muted' : '';
            adBanner.innerHTML = `<video ${muted} autoplay loop playsinline style="max-width:100%; max-height:120px;">
                <source src="${link1}" type="video/mp4">
                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ
            </video>`;
        } else {
            adBanner.innerHTML = '<div class="ad-placeholder">‚ùå –ù–µ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–∏–¥–µ–æ</div>';
        }
    }
    else if (adType === 'yandex') {
        if (link1) {
            adBanner.innerHTML = link1; // –í—Å—Ç–∞–≤–ª—è–µ–º HTML-–∫–æ–¥
        } else {
            adBanner.innerHTML = '<div class="ad-placeholder">‚ùå –ù–µ—Ç –∫–æ–¥–∞ —Ä–µ–∫–ª–∞–º—ã</div>';
        }
    }
    else {
        adBanner.innerHTML = `<div class="ad-placeholder">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Ä–µ–∫–ª–∞–º—ã: ${adType}</div>`;
    }
}

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∫–ª–∞–º—É –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
function forceReloadAd() {
    loadAdFromSheet();
}

// ======== –í–†–ï–ú–ï–ù–ù–ê–Ø –†–ï–ö–õ–ê–ú–ê (–¥–ª—è —Ç–µ—Å—Ç–∞ –≤ –∞–¥–º–∏–Ω–∫–µ) ========

// –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–æ–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ —Ä–µ–∫–ª–∞–º—ã
function toggleAdInputs() {
    const adType = document.getElementById('adType').value;
    document.getElementById('imageAdInput').classList.add('hidden');
    document.getElementById('videoAdInput').classList.add('hidden');
    document.getElementById('yandexAdInput').classList.add('hidden');
    
    if (adType === 'image') {
        document.getElementById('imageAdInput').classList.remove('hidden');
    } else if (adType === 'video') {
        document.getElementById('videoAdInput').classList.remove('hidden');
    } else if (adType === 'yandex') {
        document.getElementById('yandexAdInput').classList.remove('hidden');
    }
}

// –ü–æ–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ä–µ–∫–ª–∞–º—É (–¥–ª—è —Ç–µ—Å—Ç–∞)
function showTempAd() {
    const adType = document.getElementById('adType').value;
    const adBanner = document.getElementById('adBanner');
    
    if (adType === 'none') {
        adBanner.innerHTML = '<div class="ad-placeholder">üì¢ –†–µ–∫–ª–∞–º–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞</div>';
    } 
    else if (adType === 'image') {
        const imgUrl = document.getElementById('adImageUrl').value;
        const linkUrl = document.getElementById('adLinkUrl').value || '#';
        
        if (imgUrl) {
            adBanner.innerHTML = `<a href="${linkUrl}" target="_blank"><img src="${imgUrl}" alt="–†–µ–∫–ª–∞–º–∞" style="max-width:100%;"></a>`;
        } else {
            alert('–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
            return;
        }
    }
    else if (adType === 'video') {
        const videoUrl = document.getElementById('adVideoUrl').value;
        const muted = document.getElementById('adVideoMuted').checked ? 'muted' : '';
        
        if (videoUrl) {
            adBanner.innerHTML = `<video ${muted} autoplay loop playsinline style="max-width:100%; max-height:120px;">
                <source src="${videoUrl}" type="video/mp4">
                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ
            </video>`;
        } else {
            alert('–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ');
            return;
        }
    }
    else if (adType === 'yandex') {
        const yandexCode = document.getElementById('adYandexCode').value;
        if (yandexCode) {
            adBanner.innerHTML = yandexCode;
        } else {
            alert('–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ —Ä–µ–∫–ª–∞–º–Ω–æ–π —Å–µ—Ç–∏');
            return;
        }
    }
}

// ======== –ù–û–í–û–°–¢–ò –ò –í–ö–õ–ê–î–ö–ò ========

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
function showTab(sport) {
    if(sport === 'football') {
        document.getElementById('footballTab').classList.remove('hidden');
        document.getElementById('hockeyTab').classList.add('hidden');
        document.querySelector('.tab.football').classList.add('active');
        document.querySelector('.tab.hockey').classList.remove('active');
    } else {
        document.getElementById('footballTab').classList.add('hidden');
        document.getElementById('hockeyTab').classList.remove('hidden');
        document.querySelector('.tab.football').classList.remove('active');
        document.querySelector('.tab.hockey').classList.add('active');
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
async function loadNews() {
    try {
        const response = await fetch(SHEET_URL);
        const csv = await response.text();
        
        // –†–∞–∑–±–∏—Ä–∞–µ–º CSV
        const rows = csv.split('\n').map(row => {
            let result = [];
            let inQuotes = false;
            let current = '';
            
            for(let char of row) {
                if(char === '"' && inQuotes) {
                    inQuotes = false;
                } else if(char === '"' && !inQuotes) {
                    inQuotes = true;
                } else if(char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current);
            return result;
        });
        
        // –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –≤ –º–∞—Å—Å–∏–≤ –Ω–æ–≤–æ—Å—Ç–µ–π
        allNews = [];
        for(let i = 1; i < rows.length; i++) {
            const row = rows[i];
            if(row.length >= 4) {
                allNews.push({
                    date: row[0].replace(/"/g, ''),
                    sport: row[1].replace(/"/g, ''),
                    title: row[2].replace(/"/g, ''),
                    text: row[3].replace(/"/g, '')
                });
            }
        }
        
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º: –Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É
        allNews.sort((a, b) => {
            const dateA = a.date.split('.').reverse().join('');
            const dateB = b.date.split('.').reverse().join('');
            return dateB.localeCompare(dateA);
        });
        
        showNews();
        
    } catch(e) {
        document.getElementById('footballNews').innerHTML = '<p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>';
        document.getElementById('hockeyNews').innerHTML = '<p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>';
        console.log(e);
    }
}

// –ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏
function showNews() {
    let footballHtml = '';
    let hockeyHtml = '';
    
    allNews.forEach((item, index) => {
        const newsHtml = `
            <div class="news-item">
                <div class="news-date">${item.date}</div>
                <div class="news-title">${item.title}</div>
                <div class="news-text">${item.text}</div>
                ${isAdmin ? `<button class="delete" onclick="deleteNews(${index})">‚úñ –£–¥–∞–ª–∏—Ç—å</button>` : ''}
            </div>
        `;
        
        if(item.sport === '–§—É—Ç–±–æ–ª') {
            footballHtml += newsHtml;
        } else {
            hockeyHtml += newsHtml;
        }
    });
    
    document.getElementById('footballNews').innerHTML = footballHtml || '<p>–ù–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π</p>';
    document.getElementById('hockeyNews').innerHTML = hockeyHtml || '<p>–ù–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π</p>';
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏
function addNews(sport) {
    if(!isAdmin) return;
    
    const date = document.getElementById(sport === 'football' ? 'fDate' : 'hDate').value;
    const title = document.getElementById(sport === 'football' ? 'fTitle' : 'hTitle').value;
    const text = document.getElementById(sport === 'football' ? 'fText' : 'hText').value;
    const sportName = sport === 'football' ? '–§—É—Ç–±–æ–ª' : '–•–æ–∫–∫–µ–π';
    
    if(!title || !text) {
        alert('–ó–∞–ø–æ–ª–Ω–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ç–µ–∫—Å—Ç!');
        return;
    }
    
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –Ω–æ–≤–æ—Å—Ç—å
    const newNews = {
        date: date,
        sport: sportName,
        title: title,
        text: text
    };
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ –º–∞—Å—Å–∏–≤–∞
    allNews.unshift(newNews);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
    showNews();
    
    // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
    if(sport === 'football') {
        document.getElementById('fTitle').value = '';
        document.getElementById('fText').value = '';
    } else {
        document.getElementById('hTitle').value = '';
        document.getElementById('hText').value = '';
    }
    
    alert('–ù–æ–≤–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞! (–≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ)');
}

// –£–¥–∞–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏
function deleteNews(index) {
    if(!isAdmin) return;
    
    if(confirm('–£–¥–∞–ª–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å?')) {
        allNews.splice(index, 1);
        showNews();
    }
}

// ======== –í–•–û–î –í –ê–î–ú–ò–ù–ö–£ ========

function showLogin() {
    document.getElementById('loginModal').classList.remove('hidden');
}

function hideLogin() {
    document.getElementById('loginModal').classList.add('hidden');
    document.getElementById('passwordInput').value = '';
    document.getElementById('loginError').innerHTML = '';
}

function checkPassword() {
    const pwd = document.getElementById('passwordInput').value;
    if(pwd === SECRET_PASSWORD) {
        isAdmin = true;
        document.getElementById('adminPanel').classList.remove('hidden');
        hideLogin();
        showNews(); // –û–±–Ω–æ–≤–ª—è–µ–º, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
    } else {
        document.getElementById('loginError').innerHTML = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!';
    }
}

function logout() {
    isAdmin = false;
    document.getElementById('adminPanel').classList.add('hidden');
    showNews(); // –£–±–∏—Ä–∞–µ–º –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
}

// ======== –ó–ê–ü–£–°–ö ========

// –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å—ë –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
window.onload = function() {
    loadNews();
    loadAdFromSheet();
    
    // –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∫–ª–∞–º—É (—á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ)
    setInterval(loadAdFromSheet, 5 * 60 * 1000);
};

// –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–æ—Ç–∞—Ü–∏—é –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
window.addEventListener('beforeunload', function() {
    if (adRotationTimer) {
        clearInterval(adRotationTimer);
    }
});
</script>

</body>
</html>



